---
title: "Homework 02"
author: "Konrat Pekkip"
output: github_document
---

```{r load-packages, message = FALSE, include = FALSE}
#load required packages
library(tidyverse)
library(fs)
library(ggridges)
library(dsbox)
library(janitor)
library(stringr)
```

1.  **A new day, a new plot, a new geom.**

```{r exercise-1}
#create ridge density plot of airbnb review scores by neighorhood
edibnb %>%
  group_by(neighbourhood) %>%
  mutate(median_review = median(review_scores_rating, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(neighbourhood = fct_reorder(.f = neighbourhood, .x = median_review, .fun = median)) %>%
  ggplot(data = subset(., !is.na(neighbourhood)),
         mapping = aes(x = review_scores_rating, 
                       y = neighbourhood,
                       fill = neighbourhood))+
  geom_density_ridges(na.rm = TRUE,
                      quantile_lines=TRUE,
                      quantile_fun=function(x,...)median(x),
                      show.legend = FALSE)+
  theme_minimal()+
  labs(title = "Distribution of AirBnB Review Scores by Neighborhood of Edinburgh",
       subtitle = "In Descending Order Based on Median Review Score",
       x = "Density of AirBnB Review Scores",
       y = "Neighborhood",
       caption = "Source: dsbox Package in R")
```

The above plot showcases the distribution and density of AirBnb review scores by neighborhood for the city of Edinburgh in Scotland. The vertical lines indicate the median review score of AirBnBs in a given neighborhood, by which the neighborhoods are also sorted along the y axis. Morningside and Bruntsfield appear to be the neighborhoods with the most popular median AirBnB offerings, as their median ratings are the highest. The distribution of AirBnB reviews appears to differ by neighborhood as well; some neighborhoods (e.g. Tollcross and Southside) have a greater left-skewed tail of the distribution, indicating a greater propensity towards (relatively) lower review scores. Overall, I think the distribution of AirBnb review scores is rather similar across neighborhoods, which might indicate that there is not much of a qualitative difference in AirBnB offerings by neighborhood of Edinburgh. It would be interesting to compare Edinburgh to other cities like Glasgow or Dundee to get a better understanding whether this is a broader trend across Scottish cities, or specific to Edinburgh.

2.  **Key lyme pie.**

```{r exercise-2}
#create data frame

#create pie chart

#present information as bar graph
```

3.  **Foreign Connected PACs.**

```{r load-pac-data}
# get a list of files with "Foreign Connected PAC" in their names
list_of_files <- dir_ls(path = "data", regexp = "Foreign Connected PAC")

# read all files and row bind them
# keeping track of the file name in a new column called year
pac <- read_csv(list_of_files, id = "year")

#clean data and pivot_longer the dems/repubs variables
pac2 <- pac %>%
  clean_names() %>%
  separate(col = country_of_origin_parent_company,
           into = c("country_of_origin", "parent_company"),
           sep = '/') %>%
  separate(col = year,
           into = c("remove","year"),
           sep = "-") %>%
  select(-remove) %>%
  mutate(year = as.numeric(str_remove(string = year,
                           pattern = ".csv"))) %>%
  pivot_longer(cols = c("dems", "repubs"),
               names_to = "party",
               values_to = "contribution_amount") %>%
  mutate(contribution_amount = as.numeric(str_remove(string = contribution_amount,
                                                     pattern = "\\$")),
         total = as.numeric(str_remove(string = total,
                                       pattern = "\\$")))

test <- pac2 %>%
  group_by(year) %>%
  mutate(totalsum = sum(total))

#recreate visualization
test %>%
  group_by(party) %>%
  ggplot(mapping = aes(x = year, y = totalsum, color = party), na.rm = TRUE)+
  geom_line()
```


4.  **Hop on.**

